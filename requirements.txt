WaterBuddy+ â€” Library Routines, Constants, Data, and State
==========================================================

PURPOSE
-------
This document lists all functions (library routines), constants, data arrays,
and session state keys used by the WaterBuddy+ Streamlit app.

LIBRARIES USED
--------------
- streamlit
- PIL.Image
- PIL.ImageDraw
- datetime (date handling)

CONSTANTS (DESIGN & DIMENSIONS)
-------------------------------
PALETTE keys:
  blue, cyan, teal, green, red, orange, indigo, purple, gray, text, muted, border

DIMENSIONS keys:
  kpi_font, header_font, subheader_font, huge_font, card_radius,
  button_height, input_height, bottle_width, bottle_height

APP DATA ARRAYS
---------------
TIPS (list of hydration tips)
CONDITION_OPTIONS (list of health condition options shown in UI)

CORE HYDRATION ROUTINES (FUNCTIONS)
-----------------------------------
1) compute_bmi
   - Input: height_cm (float), weight_kg (float)
   - Output: bmi_value (float), bmi_category (str), bmi_adjustment_ml (int)
   - Logic:
       Underweight  -> -200 ml
       Normal       ->   0 ml
       Overweight   -> +200 ml

2) age_base_goal
   - Input: age (int)
   - Output: base_goal_ml (int)
   - Mapping:
       4â€“8   -> 1200 ml
       9â€“13  -> 1700 ml
       14â€“64 -> 2000 ml
       65+   -> 1700 ml

3) condition_adjustment
   - Input: condition (str; one of CONDITION_OPTIONS)
   - Output: adjustment_ml (int)
   - Mapping:
       Normal / Healthy            ->    0
       Athlete / High Activity     -> +300
       Hot Climate                 -> +200
       Pregnant                    -> +250
       Diabetic                    -> +150
       Kidney / Heart              -> -300

4) personalized_goal
   - Input: age (int), height (float), weight (float), condition (str)
   - Output: dict with keys:
       goal (int), base (int), bmi (float), bmi_cat (str),
       bmi_adj (int), cond_adj (int)
   - Formula:
       final_goal = age_base_goal(age) + bmi_adjustment + condition_adjustment

UI HELPER ROUTINE
-----------------
5) mascot
   - Input: progress_pct (int 0..100)
   - Output: emoji (str), headline (str)
   - Milestones:
       0%    -> "ðŸ˜", "Let's Begin!"
       25%+  -> "ðŸ˜Š", "Good Start!"
       50%+  -> "ðŸ‘", "Great progress!"
       75%+  -> "ðŸ’ª", "Almost there!"
       100%+ -> "ðŸŽ‰", "Amazing!"

VISUALIZATION ROUTINE
---------------------
6) draw_bottle
   - Input: progress_pct (float), width (int), height (int)
   - Output: PIL.Image (rendered bottle with fill level)
   - Notes:
       Uses rectangles, ellipse and polygon primitives for wide Pillow compatibility.
       Includes a simple wave line and a droplet icon.

SCREEN ROUTINES (NAVIGATION FLOW)
---------------------------------
7) welcome_screen
   - Onboarding UI with inputs (age, height, weight, condition)
   - Shows condition adjustment preview
   - CTA: "Calculate My Goal â†’" â†’ goes to summary

8) summary_screen
   - Displays profile (age, height, weight, BMI + category)
   - Shows goal calculation breakdown (base, BMI adj, condition adj)
   - Prominent daily goal display
   - Actions: "â† Back" (to welcome), "Start Tracking! â†’" (to tracker)

9) tracker_screen
   - KPI row: Todayâ€™s Goal / Progress % / Remaining ml
   - Mascot emoji + banner ("Time to hydrate!" or "Good start! Keep drinking!")
   - Bottle card with fill visualization, numeric progress, and percentage bar
   - Quick add: +250 ml and +500 ml
   - Custom amount input + Add
   - Tip rotator (cycles through TIPS)
   - Reset confirmation panel (styled warning and progress preview)
   - Balloons celebration at 100%

SESSION STATE KEYS (st.session_state)
-------------------------------------
- screen        : "welcome" | "summary" | "tracker"
- profile       : {"age": int, "height": float, "weight": float, "condition": str}
- intake        : int (current daily intake in ml)
- tip_index     : int (index within TIPS)
- show_reset    : bool (whether reset confirmation panel is visible)
- day           : date (used to auto-reset intake on new calendar day)

DERIVED VALUES (FORMULAE)
-------------------------
- remaining_ml      = max(0, goal_ml - intake_ml)
- progress_fraction = min(1.0, intake_ml / goal_ml) if goal_ml > 0 else 0.0
- progress_percent  = int(progress_fraction * 100)
